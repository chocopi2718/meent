many codes for scattering matrix method are from this github: https://github.com/zhaonat/Rigorous-Coupled-Wave-Analysis

also refer our fork
https://github.com/yonghakim/zhaonat-rcwa